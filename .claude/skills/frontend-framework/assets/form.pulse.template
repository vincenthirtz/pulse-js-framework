@component {{NAME}}Form

import { useForm, validators } from 'pulse-js-framework/runtime/form'

props {
  onSubmit: function
  initialValues: object = {}
}

state {
  submitting: false
  submitError: null
}

computed {
  // Form instance with validation
  form: useForm(
    {
      // Form fields with initial values
      email: initialValues.email ?? '',
      password: initialValues.password ?? '',
      // Add more fields as needed
    },
    {
      // Validation rules
      email: [
        validators.required('Email is required'),
        validators.email('Please enter a valid email')
      ],
      password: [
        validators.required('Password is required'),
        validators.minLength(8, 'Password must be at least 8 characters')
      ]
    },
    {
      onSubmit: handleSubmit,
      onError: (errors) => console.error('Validation errors:', errors)
    }
  )
}

actions {
  async handleSubmit(values) {
    submitting = true
    submitError = null
    try {
      await onSubmit(values)
    } catch (e) {
      submitError = e.message
    } finally {
      submitting = false
    }
  }
}

view {
  form.{{name}}-form @submit(form.handleSubmit) {
    @if(submitError) {
      .form-error[role=alert] { "{submitError}" }
    }

    .form-group {
      label[for=email] { "Email" }
      input#email[type=email][autocomplete=email]
        [value={form.fields.email.value}]
        [aria-invalid={!!form.fields.email.error}]
        [aria-describedby={form.fields.email.error ? 'email-error' : null}]
        @input(form.fields.email.onChange)
        @blur(form.fields.email.onBlur)
      @if(form.fields.email.error) {
        span#email-error.field-error { "{form.fields.email.error}" }
      }
    }

    .form-group {
      label[for=password] { "Password" }
      input#password[type=password][autocomplete=current-password]
        [value={form.fields.password.value}]
        [aria-invalid={!!form.fields.password.error}]
        @input(form.fields.password.onChange)
        @blur(form.fields.password.onBlur)
      @if(form.fields.password.error) {
        span.field-error { "{form.fields.password.error}" }
      }
    }

    .form-actions {
      button[type=submit][disabled={submitting || !form.isValid}] {
        @if(submitting) { "Submitting..." }
        @else { "Submit" }
      }
    }
  }
}

style {
  .{{name}}-form {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    max-width: 400px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .form-group label {
    font-weight: 500;
  }

  .form-group input {
    padding: 0.75rem;
    border: 1px solid var(--color-border, #ccc);
    border-radius: 4px;
    font-size: 1rem;
  }

  .form-group input[aria-invalid=true] {
    border-color: var(--color-error, #dc3545);
  }

  .field-error, .form-error {
    color: var(--color-error, #dc3545);
    font-size: 0.875rem;
  }

  .form-error {
    padding: 1rem;
    background: var(--color-error-bg, #f8d7da);
    border-radius: 4px;
  }

  .form-actions {
    margin-top: 1rem;
  }

  button[type=submit] {
    padding: 0.75rem 1.5rem;
    background: var(--color-primary, #007bff);
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 1rem;
    cursor: pointer;
  }

  button[type=submit]:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
}
