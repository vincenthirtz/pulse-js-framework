/**
 * Forecast Component - 7-day weather forecast
 */

@page Forecast

props {
  forecast: []
  unit: "celsius"
}

view {
  .forecast {
    h3 "ğŸ“… 7-Day Forecast"
    .forecast-list {
      @for (day of forecast) {
        .forecast-item {
          .forecast-day "{formatDay(day.date)}"
          .forecast-icon "{getWeatherIcon(day.code)}"
          .forecast-temps "{convertTemp(day.tempMax)}Â° / {convertTemp(day.tempMin)}Â°"
          .forecast-precip "ğŸ’§ {day.precipitation}%"
        }
      }
    }
  }
}

actions {
  getWeatherCodes() {
    return {
      0: { icon: "â˜€ï¸" },
      1: { icon: "ğŸŒ¤ï¸" },
      2: { icon: "â›…" },
      3: { icon: "â˜ï¸" },
      45: { icon: "ğŸŒ«ï¸" },
      48: { icon: "ğŸŒ«ï¸" },
      51: { icon: "ğŸŒ§ï¸" },
      53: { icon: "ğŸŒ§ï¸" },
      55: { icon: "ğŸŒ§ï¸" },
      61: { icon: "ğŸŒ§ï¸" },
      63: { icon: "ğŸŒ§ï¸" },
      65: { icon: "ğŸŒ§ï¸" },
      71: { icon: "â„ï¸" },
      73: { icon: "â„ï¸" },
      75: { icon: "â„ï¸" },
      80: { icon: "ğŸŒ¦ï¸" },
      81: { icon: "ğŸŒ¦ï¸" },
      82: { icon: "â›ˆï¸" },
      95: { icon: "â›ˆï¸" },
      96: { icon: "â›ˆï¸" },
      99: { icon: "â›ˆï¸" }
    }
  }

  getWeatherIcon(code) {
    const codes = getWeatherCodes()
    return codes[code] ? codes[code].icon : "â“"
  }

  convertTemp(celsius) {
    if (unit === "fahrenheit") {
      return Math.round(celsius * 9/5 + 32)
    }
    return celsius
  }

  formatDay(dateStr) {
    const date = new Date(dateStr)
    return date.toLocaleDateString("en", { weekday: "short" })
  }
}

style {
  .forecast {
    background: var(--card-bg);
    border-radius: var(--radius);
    padding: 24px;
    box-shadow: var(--shadow);
    animation: fadeIn 0.4s ease;
  }

  .forecast h3 {
    margin-bottom: 16px;
  }

  .forecast-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 12px;
  }

  .forecast-item {
    background: #f8f9fa;
    padding: 16px 12px;
    border-radius: 12px;
    text-align: center;
    transition: transform 0.2s;
  }

  .forecast-item:hover {
    transform: translateY(-4px);
  }

  .forecast-day {
    font-weight: 600;
    margin-bottom: 8px;
  }

  .forecast-icon {
    font-size: 2em;
    margin-bottom: 8px;
  }

  .forecast-temps {
    font-size: 0.9em;
    margin-bottom: 4px;
  }

  .forecast-precip {
    font-size: 0.8em;
    color: var(--text-light);
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
}
